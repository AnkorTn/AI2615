【问题分析】

分层图最短路径问题。

【建模方法】

用P位二进制表示当前获得的钥匙状态，建立2^P层图。每层图表示在当前钥匙状态下的地图，每获得一把钥匙进入新的一层，BFS求最短路即可。