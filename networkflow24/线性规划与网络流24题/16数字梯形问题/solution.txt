【问题分析】

求图的最大权不相交路径及其变种，用费用最大流解决。

【建模方法】

规则(1)

把梯形中每个位置抽象为两个点<i.a>,<i.b>，建立附加源S汇T。

1、对于每个点i从<i.a>到<i.b>连接一条容量为1，费用为点i权值的有向边。
2、从S向梯形顶层每个<i.a>连一条容量为1，费用为0的有向边。
3、从梯形底层每个<i.b>向T连一条容量为1，费用为0的有向边。
4、对于每个点i和下面的两个点j，分别连一条从<i.b>到<j.a>容量为1，费用为0的有向边。

求最大费用最大流，费用流值就是结果。

规则(2)

把梯形中每个位置看做一个点i，建立附加源S汇T。

1、从S向梯形顶层每个i连一条容量为1，费用为0的有向边。
2、从梯形底层每个i向T连一条容量为无穷大，费用为0的有向边。
3、对于每个点i和下面的两个点j，分别连一条从i到j容量为1，费用为点i权值的有向边。

求最大费用最大流，费用流值就是结果。

规则(3)

把梯形中每个位置看做一个点i，建立附加源S汇T。

1、从S向梯形顶层每个i连一条容量为1，费用为0的有向边。
2、从梯形底层每个i向T连一条容量为无穷大，费用为0的有向边。
3、对于每个点i和下面的两个点j，分别连一条从i到j容量为无穷大，费用为点i权值的有向边。

求最大费用最大流，费用流值就是结果。

【建模分析】

对于规则1，要求路径完全不相交，也就是每个点最多只能被访问了一次，所以要把点拆分，之间连接容量为1的边。因为任意一条ST之间的路径都是一个解，在拆分的点内部的边费用设为点的权值，求最大费用最大流就是费用最大的m条路经。

对于规则2，要求路径可以相交，但不能有重叠，此时可以不必拆点了。为了保证路径没有重叠，需要在相邻的两个点上限制流量为1，由于顶层的每个点只能用1次，S向顶层点流量限制也为1。费用只需设在相邻点的边上，求最大费用最大流即可。

对于规则3，要求路径除了顶层每个点以外可以任意相交重叠。在规则2的基础上，取消除S到顶层顶点之间的边以外所有边的流量限制即可。